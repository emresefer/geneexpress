options(warn=-1)
x=c(0.5,0.5,0.5,0.5,1.0,1.0,1.0,1.0,1.5,1.5,1.5,1.5,3.0,3.0,3.0,3.0,3.0,7.0,7.0,7.0,7.0,7.0,7.5,7.5,8.0,8.0,8.0,8.0,8.5,8.5,8.5,8.5,9.0,9.0,9.0,9.0,9.5,9.5,9.5,9.5,10.0,10.0,10.0,10.0,10.5,10.5,10.5,10.5,11.0,11.0,11.0,11.0,13.5,13.5,13.5,28.0,28.0,28.0,28.0)
y=c(-0.111,0.158,-0.372,0.325,0.648,0.684,0.49,-0.435,0.49,-0.142,0.49,-0.142,-0.648,-0.435,-0.174,0.39,-0.026,0.158,-0.142,0.39,-0.08,-0.24,0.289,-1.24,-0.496,0.648,-0.561,-0.337,-0.337,-0.407,0.454,0.419,0.49,0.037,-0.838,0.037,-0.89,-0.08,0.128,-2.413,-0.274,-0.496,0.419,-0.111,-0.496,0.49,-0.561,0.792,-0.053,-0.337,0.223,0.098,0.565,0.362,-4.343,0.49,1.07,0.964,0.648)
rempoints=c(4.5,4.5,4.5,4.5,11.5,11.5,11.5,11.5,2.0,2.0,2.0,2.0,2.0,4.0,4.0,4.0,4.0,5.0,5.0,5.0,5.0,6.0,6.0,6.0,6.0,12.0,12.0,12.0,12.0,13.0,13.0,13.0,13.0,14.0,14.0,14.0,14.0,15.0,15.0,15.0,15.0,16.0,16.0,16.0,16.0,17.0,17.0,17.0,17.0,18.0,18.0,18.0,18.0,19.0,19.0,19.0,19.0,20.0,20.0,20.0,21.0,21.0,21.0,21.0,22.0,22.0,22.0,22.0,23.0,23.0,23.0,23.0,24.0,24.0,24.0,24.0,25.0,25.0,25.0,25.0,26.0,26.0,26.0,26.0,27.0,27.0,27.0,27.0,12.5,12.5,12.5,12.5,3.5,3.5,3.5,3.5,2.5,2.5,2.5,2.5,6.5,6.5,6.5,6.5,5.5,5.5,5.5,5.5)
remvals=c(0.289,-0.435,-0.174,-0.026,-0.24,0.223,0.289,0.037,0.881,0.607,0.39,0.648,0.362,0.223,0.158,0.158,0.098,-1.736,-0.274,0.362,-0.111,0.49,0.223,-0.142,0.419,0.289,0.158,0.223,-0.026,0.223,0.068,0.419,0.648,-0.274,-0.142,0.565,0.158,0.037,0.158,0.158,0.419,0.128,-0.756,0.158,0.648,1.07,0.128,0.158,0.289,0.419,0.648,0.49,0.565,0.419,0.419,0.362,0.362,0.792,0.362,-0.08,0.419,0.72,0.419,0.565,0.419,0.648,0.362,-0.756,-0.08,0.223,0.419,0.792,0.648,0.648,0.565,0.49,0.648,1.07,0.72,0.648,0.49,0.565,0.792,0.792,0.964,0.964,0.72,0.792,0.158,0.128,0.49,0.362,-0.62,-0.207,0.037,-0.864,-0.026,0.49,0.362,0.191,0.289,0.098,0.607,0.158,-0.306,-0.673,0.256,0.362)
l <- list("0.5" = c(-0.111,0.158,-0.372,0.325),"1.0" = c(0.648,0.684,0.49,-0.435),"2.0" = c(0.881,0.607,0.39,0.648,0.362),"3.0" = c(-0.648,-0.435,-0.174,0.39,-0.026),"4.0" = c(0.223,0.158,0.158,0.098),"5.0" = c(-1.736,-0.274,0.362,-0.111),"1.5" = c(0.49,-0.142,0.49,-0.142),"7.0" = c(0.158,-0.142,0.39,-0.08,-0.24),"8.0" = c(-0.496,0.648,-0.561,-0.337),"9.0" = c(0.49,0.037,-0.838,0.037),"10.0" = c(-0.274,-0.496,0.419,-0.111),"11.0" = c(-0.053,-0.337,0.223,0.098),"12.0" = c(0.289,0.158,0.223,-0.026),"13.0" = c(0.223,0.068,0.419,0.648),"14.0" = c(-0.274,-0.142,0.565,0.158),"15.0" = c(0.037,0.158,0.158,0.419),"16.0" = c(0.128,-0.756,0.158,0.648),"4.5" = c(0.289,-0.435,-0.174,-0.026),"18.0" = c(0.419,0.648,0.49,0.565),"19.0" = c(0.419,0.419,0.362,0.362),"11.5" = c(-0.24,0.223,0.289,0.037),"21.0" = c(0.419,0.72,0.419,0.565),"22.0" = c(0.419,0.648,0.362,-0.756),"23.0" = c(-0.08,0.223,0.419,0.792),"12.5" = c(0.158,0.128,0.49,0.362),"5.5" = c(-0.306,-0.673,0.256,0.362),"26.0" = c(0.49,0.565,0.792,0.792),"27.0" = c(0.964,0.964,0.72,0.792),"13.5" = c(0.565,0.362,-4.343),"8.5" = c(-0.337,-0.407,0.454,0.419),"9.5" = c(-0.89,-0.08,0.128,-2.413),"6.0" = c(0.49,0.223,-0.142,0.419),"28.0" = c(0.49,1.07,0.964,0.648),"24.0" = c(0.648,0.648,0.565,0.49),"2.5" = c(-0.026,0.49,0.362,0.191),"3.5" = c(-0.62,-0.207,0.037,-0.864),"10.5" = c(-0.496,0.49,-0.561,0.792),"17.0" = c(1.07,0.128,0.158,0.289),"25.0" = c(0.648,1.07,0.72,0.648),"20.0" = c(0.792,0.362,-0.08),"7.5" = c(0.289,-1.24),"6.5" = c(0.289,0.098,0.607,0.158))
spl <- smooth.spline(x,y,cv=TRUE)
sumval = 0.0
for(ind in seq_along(rempoints)){
   sumval = sumval + (predict(spl,rempoints[ind])$y - remvals[ind])**2;}
outerr <- list()
for(item in names(l)){
varsum = 0.0
for(item2 in l[[item]]){
   varsum = varsum + (item2-predict(spl,as.numeric(item))$y)**2 }
outerr[[item]] = varsum }
fileConn<-file("out.txt","w")
write(format(sumval), fileConn)
write("error",fileConn, append=TRUE)
write(sapply(names(l),function(x) paste(x,paste(outerr[[x]],collapse=))), fileConn, append=TRUE)
write("knots",fileConn, append=TRUE)
write(format(spl$fit$knot),fileConn, append=TRUE)
close(fileConn)
